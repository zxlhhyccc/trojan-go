<!DOCTYPE html>
<html lang="zh-CN">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>URL方案（草案） - Trojan-Go Docs</title>
<meta name="description" content="An unidentifiable mechanism that helps you bypass GFW.">
<meta name="generator" content="Hugo 0.69.2" />
<link href="https://p4gefau1t.github.io/trojan-goindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://p4gefau1t.github.io/trojan-go/developer/url/">
<link rel="stylesheet" href="https://p4gefau1t.github.io/trojan-go/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://p4gefau1t.github.io/trojan-go/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://p4gefau1t.github.io/trojan-go/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="URL方案（草案）" />
<meta property="og:description" content="Changelog encryption 格式修改为 ss;method:password 概述 感谢 @DuckSoft @StudentMain @phlinhng 对 Trojan-Go URL 方案的讨论和贡献。目前 URL 方案为草案，需要更多的实践和讨论。 Trojan-Go客户端可以接受URL，以定位" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://p4gefau1t.github.io/trojan-go/developer/url/" />
<meta property="og:image" content="https://p4gefau1t.github.io/trojan-go/images/og-image.png"/>
<meta property="og:site_name" content="Trojan-Go Docs" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://p4gefau1t.github.io/trojan-go/images/og-image.png"/>

<meta name="twitter:title" content="URL方案（草案）"/>
<meta name="twitter:description" content="Changelog encryption 格式修改为 ss;method:password 概述 感谢 @DuckSoft @StudentMain @phlinhng 对 Trojan-Go URL 方案的讨论和贡献。目前 URL 方案为草案，需要更多的实践和讨论。 Trojan-Go客户端可以接受URL，以定位"/>
<meta itemprop="name" content="URL方案（草案）">
<meta itemprop="description" content="Changelog encryption 格式修改为 ss;method:password 概述 感谢 @DuckSoft @StudentMain @phlinhng 对 Trojan-Go URL 方案的讨论和贡献。目前 URL 方案为草案，需要更多的实践和讨论。 Trojan-Go客户端可以接受URL，以定位">

<meta itemprop="wordCount" content="1278">
<meta itemprop="image" content="https://p4gefau1t.github.io/trojan-go/images/og-image.png"/>



<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Trojan-Go Docs</h1>
<a href="https://github.com/p4gefau1t/trojan-go" class="github"><i class="fab fa-github"></i></a>
<p class="description">An unidentifiable mechanism that helps you bypass GFW.</p>

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/trojan-go/">Home</a></li>
<li><a href="https://github.com/p4gefau1t">GitHub</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>URL方案（草案）</h1>
<h2 id="changelog">Changelog</h2>
<ul>
<li>encryption 格式修改为 ss;method:password</li>
</ul>
<h2 id="概述">概述</h2>
<p>感谢 @DuckSoft @StudentMain @phlinhng 对 Trojan-Go URL 方案的讨论和贡献。<strong>目前 URL 方案为草案，需要更多的实践和讨论。</strong></p>
<p>Trojan-Go<strong>客户端</strong>可以接受URL，以定位服务器资源。原则如下:</p>
<ul>
<li>
<p>遵守 URL 格式规范</p>
</li>
<li>
<p>保证人类可读，对机器友好</p>
</li>
<li>
<p>URL 的作用，是定位 Trojan-Go 节点资源，方便资源分享</p>
</li>
</ul>
<p>需要注意，基于人类可读性的考虑，禁止将 base64 等编码数据嵌入 URL 中。首先， base64 编码不能保证传输安全，其意义在于在 ASCII 信道传输非 ASCII 数据。其次，如果需要保证分享 URL 时的传输安全，请对明文 URL 进行加密，而不是修改 URL 格式。</p>
<h2 id="格式">格式</h2>
<p>基本格式如下，<code>$()</code> 代表此处需要 <code>encodeURIComponent</code>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">trojan-go://
    $(trojan-password)
    @
    trojan-host
    :
    port
/?
    sni=$(tls-sni.com)&amp;
    type=$(original|ws|h2|h2+ws)&amp;
        host=$(websocket-host.com)&amp;
        path=$(/websocket/path)&amp;
    encryption=$(ss;aes-256-gcm;ss-password)&amp;
    plugin=$(...)
#$(descriptive-text)
</code></pre></div><p>例如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">trojan-go://password1234@google.com/?sni=microsoft.com&amp;type=ws&amp;host=youtube.com&amp;path=%2Fgo&amp;encryption=ss%3Baes-256-gcm%3Afuckgfw
</code></pre></div><p>由于 Trojan-Go 兼容 Trojan，所以对于 Trojan 的 URL 方案</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">trojan://password@remote_host:remote_port
</code></pre></div><p>可以兼容接受。它等价于</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">trojan-go://password@remote_host:remote_port
</code></pre></div><p>需要注意的是，一旦服务器使用了非Trojan兼容的功能，必须使用<code>trojan-go://</code>定位服务器。这样设计的目的是使得 Trojan-Go 的 URL 不会被 Trojan 错误接受，避免污染 Trojan 用户的 URL 分享。同时，Trojan-Go 确保可以兼容接受 Trojan 的 URL。</p>
<h2 id="详述">详述</h2>
<p>注意：所有参数名和常数字符串均区分大小写。</p>
<h3 id="trojan-password"><code>trojan-password</code></h3>
<p>Trojan 的密码。
不可省略，不能为空字符串，不建议含有非 ASCII 可打印字符。
必须使用 <code>encodeURIComponent</code> 编码。</p>
<h3 id="trojan-host"><code>trojan-host</code></h3>
<p>节点 IP / 域名。
不可省略，不能为空字符串。
IPv6 地址必须扩方括号。
IDN 域名（如“百度.cn”）必须使用 <code>xn--xxxxxx</code> 格式。</p>
<h3 id="port"><code>port</code></h3>
<p>节点端口。
省略时默认为 <code>443</code>。
必须取 <code>[1,65535]</code> 中的整数。</p>
<h3 id="tls或allowinsecure"><code>tls</code>或<code>allowInsecure</code></h3>
<p>没有这个字段。
TLS 默认一直启用，除非有传输插件禁用它。
TLS 认证必须开启。无法使用根CA校验服务器身份的节点，不适合分享。</p>
<h3 id="sni"><code>sni</code></h3>
<p>自定义 TLS 的 SNI。
省略时默认与 <code>trojan-host</code> 同值。不得为空字符串。</p>
<p>必须使用 <code>encodeURIComponent</code> 编码。</p>
<h3 id="type"><code>type</code></h3>
<p>传输类型。
省略时默认为 <code>original</code>，但不可为空字符串。
目前可选值只有 <code>original</code> 和 <code>ws</code>，未来可能会有 <code>h2</code>、<code>h2+ws</code> 等取值。</p>
<p>当取值为 <code>original</code> 时，使用原始 Trojan 传输方式，无法方便通过 CDN。
当取值为 <code>ws</code> 时，使用 Websocket over TLS 传输。</p>
<h3 id="host"><code>host</code></h3>
<p>自定义 HTTP <code>Host</code> 头。
可以省略，省略时值同 <code>trojan-host</code>。
可以为空字符串，但可能带来非预期情形。</p>
<p>警告：若你的端口非标准端口（不是 80 / 443），RFC 标准规定 <code>Host</code> 应在主机名后附上端口号，例如 <code>example.com:44333</code>。至于是否遵守，请自行斟酌。</p>
<p>必须使用 <code>encodeURIComponent</code> 编码。</p>
<h3 id="path"><code>path</code></h3>
<p>当传输类型 <code>type</code> 取 <code>ws</code>、<code>h2</code>、<code>h2+ws</code> 时，此项有效。
不可省略，不可为空。
必须以 <code>/</code> 开头。
可以使用 URL 中的 <code>&amp;</code> <code>#</code> <code>?</code> 等字符，但应当是合法的 URL 路径。</p>
<p>必须使用 <code>encodeURIComponent</code> 编码。</p>
<h3 id="mux"><code>mux</code></h3>
<p>没有这个字段。
当前服务器默认一直支持 <code>mux</code>。
启用 <code>mux</code> 与否各有利弊，应由客户端决定自己是否启用。URL的作用，是定位服务器资源，而不是规定用户使用偏好。</p>
<h3 id="encryption"><code>encryption</code></h3>
<p>用于保证 Trojan 流量密码学安全的加密层。
可省略，默认为 <code>none</code>，即不使用加密。
不可以为空字符串。</p>
<p>必须使用 encodeURIComponent 编码。</p>
<p>使用 Shadowsocks 算法进行流量加密时，其格式为：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">ss;method:password
</code></pre></div><p>其中 ss 是固定内容，method 是加密方法，必须为下列之一：</p>
<ul>
<li><code>aes-128-gcm</code></li>
<li><code>aes-256-gcm</code></li>
<li><code>chacha20-ietf-poly1305</code></li>
</ul>
<p>其中的 <code>password</code> 是 Shadowsocks 的密码，不得为空字符串。
<code>password</code> 中若包含分号，不需要进行转义。
<code>password</code> 应为英文可打印 ASCII 字符。</p>
<p>其他加密方案待定。</p>
<h3 id="plugin"><code>plugin</code></h3>
<p>额外的插件选项。本字段保留。
可省略，但不可以为空字符串。</p>
<h3 id="url-fragment--后内容">URL Fragment (# 后内容)</h3>
<p>节点说明。
不建议省略，不建议为空字符串。</p>
<p>必须使用 <code>encodeURIComponent</code> 编码。</p>
<div class="edit-meta">

<br><a href="https://github.com/p4gefau1t/trojan-go/docs/edit/master/content/developer/url.md" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class="pagination"><a class="nav nav-prev" href="https://p4gefau1t.github.io/trojan-go/developer/plugin/" title="可插拔传输层插件开发"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 可插拔传输层插件开发</a>
<a class="nav nav-next" href="https://p4gefau1t.github.io/trojan-go/developer/overview/" title="基本介绍">Next - 基本介绍 <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go">Home</a></li>

<li class=""><a href="https://p4gefau1t.github.io/trojan-go/basic/">基本配置</a>
  
<ul class="sub-menu">
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/basic/trojan/">Trojan基本原理</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/basic/config/">正确配置Trojan-Go</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/basic/full-config/">完整的配置文件</a></li>
</ul>
  
</li>

<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/">高级配置</a>
  
<ul class="sub-menu">
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/mux/">启用多路复用提升网络并发性能</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/websocket/">使用Websocket进行CDN转发和抵抗中间人攻击</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/router/">国内直连和广告屏蔽</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/forward/">隧道和反向代理</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/nginx-relay/">一种基于SNI代理的多路径分流中继方案</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/plugin/">使用Shadowsocks插件/可插拔传输层</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/aead/">使用Shadowsocks AEAD进行二次加密</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/customize-protocol-stack/">自定义协议栈</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/api/">使用API动态管理用户</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/advance/nat/">透明代理</a></li>
</ul>
  
</li>

<li class="parent"><a href="https://p4gefau1t.github.io/trojan-go/developer/">实现细节和开发指南</a>
  
<ul class="sub-menu">
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/overview/">基本介绍</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/build/">编译和自定义Trojan-Go</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/trojan/">Trojan协议</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/mux/">多路复用</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/websocket/">Websocket</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/simplesocks/">SimpleSocks协议</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/api/">API开发</a></li>
<li class=""><a href="https://p4gefau1t.github.io/trojan-go/developer/plugin/">可插拔传输层插件开发</a></li>
<li class="active"><a href="https://p4gefau1t.github.io/trojan-go/developer/url/">URL方案（草案）</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
